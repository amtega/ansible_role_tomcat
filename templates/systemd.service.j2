{{ ansible_managed | comment }}
[Unit]
Description=Tomcat instance {{ instance.name }}
After=network.target

[Service]
Type=forking
PIDFile={{ instance.base }}/{{ instance.pid_file | default(tomcat_instance_pid_file) }}
User={{ instance.user | default(tomcat_instance_user) }}
Group={{ instance.group | default(tomcat_instance_group) }}
Restart=on-failure
{% if instance.use_native_daemon | default(tomcat_instance_use_native_daemon)
      and instance.version is version("7", ">=") %}
Environment=JAVA_HOME={{ instance.java_home | default(tomcat_instance_java_home) }}
Environment=CATALINA_HOME={{ instance.home }}
Environment=CATALINA_BASE={{ instance.base }}
ExecStart={{ instance.base }}/bin/daemon.sh start
ExecStop={{ instance.base }}/bin/daemon.sh stop
{% else %}
ExecStart={{ instance.base }}/bin/startup.sh
ExecStop={{ instance.base }}/bin/shutdown.sh
{% endif %}
TimeoutStartSec=30
TimeoutStopSec=30
SuccessExitStatus=143

[Install]
WantedBy=multi-user.target
